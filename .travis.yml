language: c

os:
  - linux
  - osx

compiler:
  - clang
  - gcc

addons:
  apt:
    packages:
      - cmake
      - libgpgme11
      - gnupg2
      - valgrind
  homebrew:
    update: true
    packages:
      - cmake
      - gpgme
      - gnupg2

before_script:
  - mkdir build
  - cd build
  - cmake -DCMAKE_INSTALL_PREFIX=/usr/local ..

script:
  - ./run-build.sh

after_failure:
  - echo "Test ouput:"
  - cat test/out.log